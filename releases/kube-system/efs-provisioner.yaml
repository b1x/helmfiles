repositories:
  - name: stable
    url: https://kubernetes-charts.storage.googleapis.com

releases:
  - name: efs-provisioner
    namespace: kube-system
    chart: stable/efs-provisioner
    version: "0.10.2"
    installed: true
    # wait: true
    values:
      - nameOverride: efs-provisioner

        # podAnnotations:
        #   cluster-autoscaler.kubernetes.io/safe-to-evict: "true"
        #   iam.amazonaws.com/role: '{{ env "EFS_PROVISIONER_IAM_ROLE" }}'

        efsProvisioner:
          efsFileSystemId: '{{ requiredEnv "EFS_FILE_SYSTEM_ID" }}'
          awsRegion: '{{ requiredEnv "AWS_REGION" }}'
          path: /shared
          provisionerName: '{{ env "EFS_PROVISIONER_NAME" | default "aws-efs" }}'
          storageClass:
            name: '{{ env "EFS_STORAGE_CLASS_NAME" | default "efs" }}'
            isDefault: '{{ env "EFS_STORAGE_CLASS_IS_DEFAULT" | default "false" }}'
            gidAllocate:
              enabled: '{{ env "EFS_STORAGE_CLASS_GID_ALLOCATE_ENABLED" | default "true" }}'
              gidMin: '{{ env "EFS_STORAGE_CLASS_GID_ALLOCATE_GID_MIN" | default "40000" }}'
              gidMax: '{{ env "EFS_STORAGE_CLASS_GID_ALLOCATE_GID_MAX" | default "50000" }}'
            reclaimPolicy: '{{ env "EFS_STORAGE_CLASS_RECLAIM_POLICY" | default "Delete" }}'
