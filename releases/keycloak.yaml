repositories:
  - name: codecentric
    url: https://codecentric.github.io/helm-charts

releases:
  - name: keycloak
    namespace: keycloak
    chart: codecentric/keycloak
    version: ~6.1.0
    installed: true
    # wait: true
    values:
      - nameOverride: keycloak

        keycloak:
          username: '{{ env "KEYCLOAK_USERNAME" | default "keycloak" }}'
          password: '{{ env "KEYCLOAK_PASSWORD" | default "password" }}'

          ingress:
            enabled: true
            annotations:
              kubernetes.io/ingress.class: nginx
              nginx.ingress.kubernetes.io/force-ssl-redirect: "true"
              cert-manager.io/cluster-issuer: "letsencrypt-prod"
              # ingress.kubernetes.io/affinity: cookie
            hosts:
              - '{{ env "KEYCLOAK_HOST" }}'
            tls:
              - secretName: keycloak-tls
                hosts:
                  - '{{ env "KEYCLOAK_HOST" }}'
