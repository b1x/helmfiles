repositories:
  - name: stable
    url: https://kubernetes-charts.storage.googleapis.com

releases:
  - name: prometheus
    namespace: monitor
    chart: stable/prometheus
    version: "9.7.4"
    installed: true
    # wait: true
    values:
      - nameOverride: prometheus

        server:
          enabled: true
          ingress:
            enabled: '{{ env "PROMETHEUS_INGRESS_ENABLED" | default "false" }}'
            annotations:
              kubernetes.io/ingress.class: nginx
              nginx.ingress.kubernetes.io/force-ssl-redirect: "true"
              cert-manager.io/cluster-issuer: "letsencrypt-prod"
            hosts:
              - '{{ env "PROMETHEUS_HOST" }}'
            tls:
              - secretName: prometheus-tls
                hosts:
                  - '{{ env "PROMETHEUS_HOST" }}'
          persistentVolume:
            enabled: '{{ env "PROMETHEUS_PV_ENABLED" | default "false" }}'
            storageClass: '{{ env "PROMETHEUS_PV_SC" | default "gp2" }}'

        alertmanager:
          enabled: '{{ env "PROMETHEUS_ALERT_MANAGER_ENABLED" | default "false" }}'
          persistentVolume:
            enabled: '{{ env "PROMETHEUS_PV_ENABLED" | default "false" }}'
            storageClass: '{{ env "PROMETHEUS_PV_SC" | default "gp2" }}'

        kubeStateMetrics:
          enabled: '{{ env "PROMETHEUS_KUBE_STATE_METRICS" | default "false" }}'
